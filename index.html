<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>COMMUNE — Locked</title>
  <meta name="description" content="COMMUNE holding page" />

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="modules.css" />

  <style>
    body.landing-locked {
      background: #f8f8f8;
      font-family: 'Helvetica LT Std', sans-serif;
      display: flex;
      justify-content: center;
      padding: 2rem 1rem; /* breathing room */
      text-align: center;
      min-height: 100vh; /* allow scrolling if content is taller */
      box-sizing: border-box;
    }

    .page-wrap {
      width: 100%;
      max-width: 480px; /* scale everything in */
      margin: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .landing-logo {
      width: clamp(120px, 22vw, 240px);
      opacity: 0.9;
      pointer-events: none;
      margin-bottom: 2rem;
    }

    .ll-frame {
      position: relative;
      width: 100%;
      aspect-ratio: 3 / 5;
      max-height: 60vh; /* keep slideshow from pushing content down */
      border: 1px solid #000;
      background: #eaeaea;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .ll-slides { position: absolute; inset: 0; }
    .ll-slide { position: absolute; inset: 0; opacity: 0; transition: opacity 0.4s ease; }
    .ll-slide.is-active { opacity: 1; }
    .ll-slide img { width: 100%; height: 100%; object-fit: cover; display: block; }

    .ll-note {
      font-size: 0.65rem;
      margin-top: 1rem;
      opacity: 0.75;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    /* Email form styling */
    .email-form {
      margin-top: 1rem;
      display: flex;
      justify-content: center;
      gap: 0.5rem;
    }

    .email-form input[type="email"] {
      padding: 0.5rem 1rem;
      border: 1px solid #000;
      font-family: 'Helvetica LT Std', sans-serif;
      font-size: 0.9rem;
      width: 200px;
      max-width: 80%;
    }

    .email-form button {
      padding: 0.5rem 1.25rem;
      border: 1px solid #000;
      background: #000;
      color: #fff;
      font-family: 'Helvetica LT Std', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .email-form button:hover {
      background: #fff;
      color: #000;
    }

    #formResponse {
      margin-top: 0.75rem;
      font-size: 0.8rem;
      opacity: 0.8;
      display: none;
    }

    /* Mobile adjustment */
    @media (max-width: 600px) {
      .ll-frame {
        max-height: 50vh; /* shrink slideshow on small screens */
      }

      .email-form {
        flex-direction: column;
        gap: 0.75rem;
        width: 100%;
      }

      .email-form input[type="email"],
      .email-form button {
        width: 100%;
        max-width: 100%;
      }
    }
  </style>
</head>
<body class="landing-locked">
  <div class="page-wrap">
    <img class="landing-logo" src="assets/images/commune-logo-main.svg" alt="COMMUNE logo" />

    <section class="ll-frame" id="llFrame" aria-label="Slideshow">
      <div class="ll-slides" id="llSlides">
        <figure class="ll-slide is-active"><img src="assets/images/landing/slide-1.jpg" alt="Slide 1" /></figure>
        <figure class="ll-slide"><img src="assets/images/landing/slide-2.gif" alt="Slide 2" /></figure>
        <!-- add more slides here -->
      </div>
    </section>

    <p class="ll-note">opening soon</p>

    <!-- Email sign-up -->
    <form class="email-form" id="emailForm">
      <input type="email" name="email" placeholder="Enter your email" required />
      <button type="submit">Sign Up</button>
    </form>
    <p id="formResponse">Thanks — you’re on the list.</p>
  </div>

  <!-- Background audio -->
  <audio id="bg-audio" src="assets/audio/entry.mp3" preload="auto" loop></audio>

  <script>
    (function(){
      // ===== Slideshow =====
      const slides = Array.from(document.querySelectorAll('.ll-slide'))
      let index = 0
      let timer
      const AUTOPLAY_MS = 2500

      function go(i){
        slides[index].classList.remove('is-active')
        index = (i + slides.length) % slides.length
        slides[index].classList.add('is-active')
        restart()
      }

      function nextSlide(){ go(index + 1) }
      function restart(){ clearInterval(timer); timer = setInterval(nextSlide, AUTOPLAY_MS) }

      const el = document.getElementById('llFrame')
      el.addEventListener('mouseenter', () => clearInterval(timer))
      el.addEventListener('mouseleave', restart)

      restart()

      // ===== Background audio autoplay =====
      const audio = document.getElementById('bg-audio')
      audio.volume = 0.3
      audio.play().catch(() => {
        // If blocked, wait for first click/tap
        document.addEventListener('click', () => {
          audio.play()
        }, { once: true })
      })

      // ===== Email form AJAX submit =====
      const form = document.getElementById('emailForm');
      const responseMsg = document.getElementById('formResponse');

      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        const data = new FormData(form);

        const res = await fetch("https://formspree.io/f/mwpngzko", {
          method: "POST",
          body: data,
          headers: { 'Accept': 'application/json' }
        });

        if (res.ok) {
          form.reset();
          responseMsg.innerText = "Thanks — you’re on the list.";
          responseMsg.style.display = 'block';
        } else {
          responseMsg.innerText = "Something went wrong. Try again?";
          responseMsg.style.display = 'block';
        }
      });
    })()
  </script>
</body>
</html>
